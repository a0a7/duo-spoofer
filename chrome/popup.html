<!DOCTYPE html>
<script src="encryption.js"></script>
<script src="secure-storage.js"></script>
<script src="libs/buffer.js"></script>
<script src="libs/index.js"></script>
<script type="module" src="popup.js"></script>
<html>

<head>
  <link rel="stylesheet" href="styles.css" type="text/css">
</head>

<!-- display-none prevents weird visual artifacts from appearing while loading. JS clears the display -->
<body id="content" style="display: none">
  <!-- Logo centered at top -->
  <div style="text-align: center; padding: 16px 0 8px 0;">
    <img style="width: 80px; height: auto; border: none;" src="welcome/logo.png" alt="autoauth" />
  </div>
  
  <div style="display: flex; gap: 8px; align-items: center; padding: 0 16px;">
    <!-- Select device -->
    <select id="deviceSelect">
      <option value="-1">Add Device...</option>
    </select>
    <!-- Device TOTP -->
    <!-- TOTP -->
    <a id="totp">
      <svg viewBox="0 0 16 16">
        <circle cx="8" cy="8" r="4" id="totpCircle" style="animation-duration: 30s"></circle>
      </svg>
      <p id="totpCode"></p>
    </a>
    <!-- Gear SVG -->
    <div style="margin-left: auto">
      <svg id="gear" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" width="26px" height="26px"
        viewBox="0 0 24 24" fill="#000000">
        <rect fill="none" height="26" width="26"></rect>
        <path id="gearChange"
          d="M19.5,12c0-0.23-0.01-0.45-0.03-0.68l1.86-1.41c0.4-0.3,0.51-0.86,0.26-1.3l-1.87-3.23c-0.25-0.44-0.79-0.62-1.25-0.42 l-2.15,0.91c-0.37-0.26-0.76-0.49-1.17-0.68l-0.29-2.31C14.8,2.38,14.37,2,13.87,2h-3.73C9.63,2,9.2,2.38,9.14,2.88L8.85,5.19 c-0.41,0.19-0.8,0.42-1.17,0.68L5.53,4.96c-0.46-0.2-1-0.02-1.25,0.42L2.41,8.62c-0.25,0.44-0.14,0.99,0.26,1.3l1.86,1.41 C4.51,11.55,4.5,11.77,4.5,12s0.01,0.45,0.03,0.68l-1.86,1.41c-0.4,0.3-0.51,0.86-0.26,1.3l1.87,3.23c0.25,0.44,0.79,0.62,1.25,0.42 l2.15-0.91c0.37,0.26,0.76,0.49,1.17,0.68l0.29,2.31C9.2,21.62,9.63,22,10.13,22h3.73c0.5,0,0.93-0.38,0.99-0.88l0.29-2.31 c0.41-0.19,0.8-0.42,1.17-0.68l2.15,0.91c0.46,0.2,1,0.02,1.25-0.42l1.87-3.23c0.25-0.44,0.14-0.99-0.26-1.3l-1.86-1.41 C19.49,12.45,19.5,12.23,19.5,12z M12.04,15.5c-1.93,0-3.5-1.57-3.5-3.5s1.57-3.5,3.5-3.5s3.5,1.57,3.5,3.5S13.97,15.5,12.04,15.5z">
        </path>
      </svg>
    </div>
  </div>
  <hr style="margin: 8px 16px;" />

  <!-- Welcome screen -->
  <div class="screen" id="intro">
    <h4 id="disclaimerText">
      By using this extension, you understand the <a href="https://github.com/FreshSupaSulley/Auto-2FA/blob/main/README.md#security" target="_blank">risks</a>, including unauthorized access or data loss. The developers are not liable for any consequences.
    </h4>
    <hr />
    <h4>
      You're about to add a device to your Duo Mobile account. Login to your
      Duo device manager website.
    </h4>
    <button type="submit" id="introButton">Ok</button>
  </div>

  <!-- Activation screen -->
  <div class="screen" id="activation">
    <h4 id="errorSplash">
    </h4>
    <div class="steps">
      <!-- QR Code Detection Section -->
      <div class="activation-section">
        <p id="qrSearchText">Searching for a QR code...</p>
        <p id="qrErrorText"></p>
        <p style="font-weight: normal">
          Auto 2FA will find the QR code on the current tab.
        </p>
      </div>

      <hr style="margin: 20px 0" />

      <!-- Manual Activation Section -->
      <div class="activation-section">
        <h4>Manual Activation</h4>
        <p style="font-weight: normal">
          If QR code detection fails, paste your activation code below:
        </p>
        <input type="text" id="code" placeholder="Activation code" />
        <br />
        <button type="submit" id="activateButton">Activate</button>
        <p style="font-weight: normal; margin-top: 10px">
          Open the link sent to your inbox, and paste the code above.
        </p>
      </div>
    </div>

    <hr />
    <div style="display: flex; justify-content: space-between">
      <button id="helpButton">Help</button>
      <button class="toMainScreen">Back to Main</button>
    </div>
  </div>

  <!-- Main TOTP screen -->
  <div class="screen" id="main">
    <div style="display: flex; justify-content: space-between; margin-bottom: 10px">
      <button id="addDevice">Add Device</button>
      <button id="removeDevice">Remove Device</button>
    </div>
  </div>

  <!-- Activation success screen -->
  <div class="screen" id="activationSuccess">
    <h4>Success!</h4>
    <p>Your device has been added successfully.</p>
    <button class="toMainScreen">Continue</button>
  </div>

  <!-- Failed attempts / Help screen -->
  <div class="screen" id="failedAttempts">
    <h4>Need Help?</h4>
    <p>If you're having trouble activating your device:</p>
    <ul>
      <li>Make sure you're on the Duo Mobile activation page</li>
      <li>Check that the QR code is visible and not blocked</li>
      <li>Try refreshing the page and scanning again</li>
      <li>Use manual activation with the code from your email</li>
    </ul>
    <button class="toMainScreen">Back</button>
  </div>
</body>

</html>
